(function($){var methods={init:function(options,callback){$(this).click(function(e){if($(options.popupId).length>0){return false}e.preventDefault();if(options.modal){methods.modal(options.backgroundId);if(options.backgroundClose){methods.closingSelectors($(options.backgroundId),options.popupId)}}$('body').prepend('<div id="'+options.popupId+'" class="'+options.backgroundStyle+'"></div>');if(options.className!=''){$('#'+options.popupId).addClass(options.className)}$('#'+options.popupId).hide();var inner=''if(options.html&&options.src){$.error('Cannot have both html and src declerations in jqmodal, pick one or the other.')}if(options.html){methods.build(options.html,this,options.closingSelectors,options.popupId,options.backgroundId,callback)}else if(options.src){$('body').prepend('<div id="dump"></div>');$('#dump').hide().load(options.src,function(){var html=$('#dump').html();$('#dump').remove();methods.build(html,this,options.closingSelectors,options.popupId,options.backgroundId,callback)})}})},build:function(inner,clickedElement,closingSelectors,popupId,backgroundId,callback){$('#'+popupId).html(inner);var leftMarginMinusWidthHalfWay=($(window).width()/2)-($('#'+popupId).width()/2);var topMarginMinusHeightHalfWay=($(window).height()/2)-($('#'+popupId).height()/2);$('#'+popupId).css({'left':leftMarginMinusWidthHalfWay,'top':topMarginMinusHeightHalfWay});$('#'+popupId).fadeIn(300);if(closingSelectors.length>0){for(i in closingSelectors){methods.closingSelectors(closingSelectors[i],popupId,backgroundId)}}try{var tabPlace=0;var tabArray=$('#'+popupId).find(':tabbable');$(clickedElement).blur();$(window).keydown(function(e){var code=e.keyCode||e.which;if(code=='9'){if(e.shiftKey){tabPlace--;if(tabPlace==-1){tabPlace=(tabArray.length-1)}}else{tabPlace++;if(tabPlace==tabArray.length){tabPlace=0}}tabArray[tabPlace].focus();return false}})}catch(e){}if(callback){callback()}},closingSelectors:function(element,popupId,backgroundId){$(element).click(function(){if($('#'+popupId).length>0){$('#'+popupId).fadeOut(300,function(){$('#'+popupId).remove()})}if($('#'+backgroundId).length>0){$('#'+backgroundId).fadeOut(300,function(){$('#'+backgroundId).remove()})}$(window).unbind('keydown')})},modal:function(backgroundId){width=$(document).width()+100;height=$(document).height()+100;$('body').prepend('<div id="'+backgroundId+'"></div>');console.log($('body'));$('#'+backgroundId).hide();$('#'+backgroundId).fadeIn(300);$('#'+backgroundId).width(width);$('#'+backgroundId).height(height)},};$.fn.jqmodal=function(options,callback){var settings={'modal':true,'backgroundStyle':'default','html':'','className':'','src':'','closingSelectors':[],'backgroundClose':true,'popupId':'popup','backgroundId':'popupback'};if(typeof options=='object'){options=$.extend(settings,options)}return methods.init.apply(this,arguments,callback)}})(jQuery);